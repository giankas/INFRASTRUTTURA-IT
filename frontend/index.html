<!DOCTYPE html>
<html ng-app="myApp">
<head>
  <meta charset="utf-8">
  <title>Sito IT – Dashboard Clienti</title>
  <!-- Includi AngularJS -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <script src="app.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { max-width: 800px; margin: auto; }
    .section { border: 1px solid #ddd; padding: 10px; margin-bottom: 20px; }
    .nav a { margin-right: 15px; cursor: pointer; }
  </style>
</head>
<body ng-controller="MainController">
  <div class="container">
    <div class="nav">
      <a ng-click="setView('login')" ng-if="!isAuthenticated">Login</a>
      <a ng-click="setView('register')" ng-if="!isAuthenticated">Registrati</a>
      <a ng-click="setView('dashboard')" ng-if="isAuthenticated">Dashboard</a>
      <a ng-click="setView('packages')" ng-if="isAuthenticated">Pacchetti</a>
      <a ng-click="setView('orders')" ng-if="isAuthenticated">Ordini</a>
      <a ng-click="setView('contact')">Contatti</a>
      <a ng-click="logout()" ng-if="isAuthenticated">Logout</a>
    </div>
    
    <!-- Sezione Login -->
    <div class="section" ng-show="view === 'login'">
      <h3>Login</h3>
      <form ng-submit="login()">
        <input type="text" ng-model="credentials.username" placeholder="Username" required><br>
        <input type="password" ng-model="credentials.password" placeholder="Password" required><br>
        <button type="submit">Login</button>
      </form>
    </div>
    
    <!-- Sezione Registrazione -->
    <div class="section" ng-show="view === 'register'">
      <h3>Registrati</h3>
      <form ng-submit="register()">
        <input type="text" ng-model="regData.username" placeholder="Username" required><br>
        <input type="password" ng-model="regData.password" placeholder="Password" required><br>
        <button type="submit">Registrati</button>
      </form>
    </div>
    
    <!-- Dashboard: visualizza ticket, servizi attivi -->
    <div class="section" ng-show="view === 'dashboard' && isAuthenticated">
      <h3>Dashboard Clienti</h3>
      <div>
        <h4>I tuoi Ticket</h4>
        <div ng-repeat="ticket in tickets" class="ticket">
          <strong>{{ticket.title}}</strong>
          <p>{{ticket.content}}</p>
        </div>
        <h4>Apri Nuovo Ticket</h4>
        <form ng-submit="createTicket()">
          <input type="text" ng-model="newTicket.title" placeholder="Titolo" required><br>
          <textarea ng-model="newTicket.content" placeholder="Descrizione" required></textarea><br>
          <button type="submit">Invia Ticket</button>
        </form>
      </div>
      <div>
        <h4>Servizi Attivi</h4>
        <div ng-repeat="service in services">
          <strong>{{service.name}}</strong> - <span>{{service.details}}</span>
        </div>
      </div>
    </div>
    
    <!-- Sezione Pacchetti e Ordini -->
    <div class="section" ng-show="view === 'packages' && isAuthenticated">
      <h3>Pacchetti Disponibili</h3>
      <div ng-repeat="pkg in packages">
        <strong>{{pkg.name}}</strong> - {{pkg.description}} - Prezzo: €{{pkg.price}}
        <button ng-click="buyPackage(pkg.id)">Acquista</button>
      </div>
      <h3>I Tuoi Ordini</h3>
      <div ng-repeat="order in orders">
        Ordine #{{order.id}} - Pacchetto ID: {{order.package_id}} - Totale: €{{order.total_price}}
      </div>
    </div>
    
    <!-- Sezione Contatti -->
    <div class="section" ng-show="view === 'contact'">
      <h3>Contattaci</h3>
      <form ng-submit="sendContact()">
        <input type="text" ng-model="contact.name" placeholder="Il tuo nome" required><br>
        <input type="email" ng-model="contact.email" placeholder="La tua email" required><br>
        <textarea ng-model="contact.message" placeholder="Il tuo messaggio" required></textarea><br>
        <button type="submit">Invia Messaggio</button>
      </form>
    </div>
  </div>
</body>
</html>
